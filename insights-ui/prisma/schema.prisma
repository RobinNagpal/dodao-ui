// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Model for the Ticker table (provided)
model Ticker {
  tickerKey       String   @id @unique @map("ticker_key")
  reportUrl       String?  @map("report_url")
  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")
  createdBy       String?  @map("created_by")
  updatedBy       String?  @map("updated_by")
  sectorId        Int      @map("sector_id")
  industryGroupId Int      @map("industry_group_id")

  // Relation: one ticker can have many SEC filings.
  secFilings SecFiling[]

  @@map("tickers")
}

// Model for SEC filings using UUIDs and linking to a ticker via tickerKey.
model SecFiling {
  id              String                @id @default(uuid())
  tickerKey       String                @map("ticker_key")
  filingDate      DateTime              @map("filing_date")
  form            String                @map("form")
  filingUrl       String                @map("filing_url")
  accessionNumber String                @unique @map("accession_number")
  periodOfReport  String                @map("period_of_report")
  attachments     SecFilingAttachment[]
  shortSummary    String?               @map("short_summary")

  // Relation to the Ticker model
  ticker Ticker @relation(fields: [tickerKey], references: [tickerKey])

  @@map("sec_filings")
}

// Model for Filing attachments using UUIDs.
model SecFilingAttachment {
  id             String    @id @default(uuid())
  sequenceNumber String    @map("sequence_number")
  description    String    @map("description")
  purpose        String?   @map("purpose")
  url            String    @map("url")
  documentType   String    @map("document_type")
  secFilingId    String    @map("sec_filing_id")
  secFiling      SecFiling @relation(fields: [secFilingId], references: [id])

  @@map("sec_filing_attachments")
}

enum FormSize {
  xs
  s
  m
  l
  xl
}

model SecForm {
  formName         String   @id @map("form_name")
  formDescription  String   @map("form_description")
  importantItems   Json     @map("important_items")
  averagePageCount Int      @map("average_page_count")
  size             FormSize @map("size")
}
